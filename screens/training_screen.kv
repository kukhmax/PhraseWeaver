<TrainingScreen>:
    name: 'training_screen'
    MDBoxLayout:
        orientation: 'vertical'
        md_bg_color: app.theme_cls.bg_light

        MDProgressBar:
            id: progress_bar
            value: 0
            size_hint_y: None
            height: dp(4)
        
        # --- ИСПРАВЛЕНО ОКОНЧАТЕЛЬНО ---
        # ScrollView может иметь только ОДНОГО потомка.
        ScrollView:
            # Поэтому мы создаем ОДИН главный контейнер...
            MDBoxLayout:
                orientation: 'vertical'
                adaptive_height: True
                padding: "16dp"
                spacing: "16dp"

                # ... и уже ВНУТРЬ него мы кладем все наши виджеты.
                MDCard:
                    id: question_card
                    orientation: 'vertical'
                    padding: "8dp"
                    md_bg_color: app.theme_cls.bg_normal
                    size_hint_y: None
                    height: dp(300)
                    radius: [12, 12, 12, 12]

                    Image:
                        id: card_image
                        source: 'assets/placeholder.png'
                        allow_stretch: True
                
                MDBoxLayout:
                    adaptive_height: True
                    padding: "8dp"
                    MDLabel:
                        id: question_label
                        text: "Загрузка..."
                        halign: 'center'
                        font_style: "H6"
                        adaptive_height: True
                    MDIconButton:
                        id: play_audio_button
                        icon: "volume-high"
                        on_release: root.play_audio()
                
                MDBoxLayout:
                    orientation: 'vertical'
                    adaptive_height: True
                    spacing: "8dp"
                    MDTextField:
                        id: answer_input
                        hint_text: "Ваш ответ..."
                        mode: 'fill'
                        icon_right: ""
                        size_hint_y: None
                        height: 0
                        opacity: 0
                        disabled: True
                    MDLabel:
                        id: correct_answer_label
                        halign: 'center'
                        theme_text_color: "Secondary"
                        adaptive_height: True

                MDRaisedButton:
                    id: action_button
                    text: "Показать ответ"
                    pos_hint: {"center_x": 0.5}
                    on_release: root.handle_main_action()

                MDBoxLayout:
                    id: srs_buttons
                    orientation: 'horizontal'
                    adaptive_height: True
                    spacing: "8dp"
                    pos_hint: {"center_x": 0.5}
                    opacity: 0
                    disabled: True
                    MDRaisedButton:
                        text: "Снова"
                        on_release: root.evaluate_answer("again")
                    MDRaisedButton:
                        text: "Хорошо"
                        on_release: root.evaluate_answer("good")
                    MDRaisedButton:
                        text: "Легко"
                        on_release: root.evaluate_answer("easy")